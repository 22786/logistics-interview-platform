<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>1209329 Logistics Customer Discovery</title>
    <style>
        body { 
            font-family: 'Segoe UI', 'Tahoma', 'Geneva', 'Verdana', sans-serif; 
            padding: 40px; 
            background-color: #f4f7f6;
            max-width: 850px;
            margin: auto;
            line-height: 1.5;
        }
        /* ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÉ‡∏ô‡∏™‡πà‡∏ß‡∏ô <style> */
        .container {
            max-width: 1000px; /* ‡∏Ç‡∏¢‡∏≤‡∏¢‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡πÉ‡∏´‡πâ‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡∏Ç‡∏∂‡πâ‡∏ô */
            margin: auto;
        }

        .input-area { 
            display: flex; 
            gap: 15px; /* ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏ä‡πà‡∏≠‡∏á‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Å‡∏±‡∏ö‡∏õ‡∏∏‡πà‡∏° */
        }

        input[id="userInput"] { 
            flex: 9; /* ‡πÉ‡∏´‡πâ‡∏ä‡πà‡∏≠‡∏á‡∏û‡∏¥‡∏°‡∏û‡πå‡πÉ‡∏ä‡πâ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà 9 ‡∏™‡πà‡∏ß‡∏ô */
            padding: 15px; /* ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ô‡∏≤‡πÉ‡∏´‡πâ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏á‡πà‡∏≤‡∏¢‡∏Ç‡∏∂‡πâ‡∏ô */
        }

        button { 
            flex: 1; /* ‡πÉ‡∏´‡πâ‡∏õ‡∏∏‡πà‡∏°‡πÉ‡∏ä‡πâ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏Ñ‡πà 1 ‡∏™‡πà‡∏ß‡∏ô */
            min-width: 100px; /* ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥‡∏Ç‡∏≠‡∏á‡∏õ‡∏∏‡πà‡∏° */
        }
        h2 { color: #004494; margin-top: 0; }
        h3 { color: #2c3e50; font-size: 1.1em; margin-bottom: 20px; }
        
        /* Instruction Box Styling */
        .instruction-box { 
            background-color: #f0f7ff; 
            border-left: 6px solid #0056b3; 
            padding: 15px 20px; 
            margin-bottom: 25px; 
            border-radius: 4px;
            font-size: 0.95em;
        }
        .instruction-box b { color: #0056b3; }

        #chat-box { 
            border: 1px solid #e0e0e0; 
            height: 400px; 
            overflow-y: auto; 
            padding: 15px; 
            margin-bottom: 20px; 
            background-color: #ffffff;
            border-radius: 8px;
        }
        .message { margin-bottom: 15px; padding: 10px; border-radius: 5px; }
        .student-msg { color: #0056b3; font-weight: bold; background: #eef4ff; display: inline-block; padding: 5px 10px; border-radius: 5px; }
        .persona-msg { color: #2e7d32; font-weight: bold; background: #e8f5e9; display: inline-block; padding: 5px 10px; border-radius: 5px; }

        .input-area { display: flex; gap: 10px; }
        input[type="text"], select { 
            padding: 12px; 
            border: 1px solid #ccc; 
            border-radius: 6px; 
            font-size: 15px;
        }
        button { 
            padding: 10px 25px; 
            background-color: #004494; 
            color: white; 
            border: none; 
            border-radius: 6px; 
            cursor: pointer; 
            font-weight: bold;
        }
        button:hover { background-color: #003366; }
        
        .student-info-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            background: #f9f9f9;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>

<div class="container">
    <h2>1209329 Business Creation for Logistics & SCM</h2>
    <h3>Workshop: Customer Discovery (Persona Interview)</h3>
    
    <div class="instruction-box">
        <b>üìå Guidelines / ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ & ‚ö†Ô∏è Workshop Rules / ‡∏Å‡∏é‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡πÄ‡∏ß‡∏¥‡∏£‡πå‡∏Å‡∏ä‡∏≠‡∏õ:</b>
        <ul style="margin: 10px 0; padding-left: 20px;">
            <li><b>English Only:</b> These customers do not speak Thai. (‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£‡πÄ‡∏õ‡πá‡∏ô‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô)</li>
            <li><b>Be Persistent:</b> They are stressed and busy. You must ask deep questions (5 Whys) to find the truth. (‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°‡∏ñ‡∏≤‡∏°‡πÄ‡∏à‡∏≤‡∏∞‡∏•‡∏∂‡∏Å)</li>
            <li><b>Empathy First:</b> Listen to their pain before offering a solution. / ‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏à‡πá‡∏ö‡∏õ‡∏ß‡∏î‡∏Ç‡∏≠‡∏á‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏™‡∏ô‡∏≠‡∏ó‡∏≤‡∏á‡πÅ‡∏Å‡πâ</li>
            <li><b>Goal:</b> Find the "Hidden Root Cause" for your Lean Canvas. (‡∏ï‡πâ‡∏≠‡∏á‡∏´‡∏≤‡∏ï‡πâ‡∏ô‡∏ï‡∏≠‡∏ó‡∏µ‡πà‡∏ã‡πà‡∏≠‡∏ô‡∏≠‡∏¢‡∏π‡πà‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÑ‡∏õ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô Lean Canvas)</li>
            <li><b>Lean Canvas:</b> Focus on <i>Problems</i> & <i>Customer Segments</i>. / ‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏∞‡∏ö‡∏∏ Problem ‡πÅ‡∏•‡∏∞ Customer Segment</li>
        </ul>
    </div>

    <div class="student-info-grid">
        <div>
            <label><b>Student Name / ‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•:</b></label>
            <input type="text" id="studentName" placeholder="Full name" style="width: 90%;">
        </div>
        <div>
            <label><b>Student ID / ‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤:</b></label>
            <input type="text" id="studentId" placeholder="Student ID" style="width: 90%;">
        </div>
    </div>
    
    <label for="role"><b>Target Interviewee / ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏π‡πâ‡πÉ‡∏´‡πâ‡∏™‡∏±‡∏°‡∏†‡∏≤‡∏©‡∏ì‡πå:</b></label>
    <select id="role">
        <option value="somchai_retailer">Mr. Somchai (Traditional Retail)</option>
        <option value="vina_shipper">Ms. Vina (Warehouse)</option>
        <option value="lisa_startup">Lisa (Tech Founder)</option>
        <option value="bruno_driver">Bruno (Truck Driver)</option>
        <option value="marbel_forwarder">Marbel (Freight Forwarder)</option>
        <option value="ed_procurement">Ed (Factory Manager)</option>
        <option value="billie_seller">Billie (E-commerce)</option>
    </select>
    
<div class="form-group" style="margin-top: 15px; padding: 15px; background-color: #e3f2fd; border-radius: 8px; border: 1px solid #90caf9;">
    <label for="apiKeyInput" style="font-weight: bold; color: #0d47a1;">üîë Your Groq API Key (Required):</label>
    <input type="password" id="apiKeyInput" class="form-control" placeholder="gsk_xxxxxxxxxxxxxxxx" required style="width: 100%; padding: 8px; margin-top: 5px;">
    <small style="display: block; margin-top: 5px; color: #555;">
        *‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏™‡πà Key ‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô (‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏ü‡∏£‡∏µ‡∏ó‡∏µ‡πà <a href="https://console.groq.com/keys" target="_blank">Groq Console</a>)
    </small>
</div>

    <div id="chat-box">
        <div class="message"><span class="persona-msg">System:</span> 
            Please enter your info and start your interview. / ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡∏∞‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏™‡∏±‡∏°‡∏†‡∏≤‡∏©‡∏ì‡πå
        </div>
    </div>

    <div class="input-area" style="flex-direction: column;"> <textarea id="userInput" placeholder="Type your interview question in English... / ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏†‡∏≤‡∏©‡∏ì‡πå‡πÄ‡∏õ‡πá‡∏ô‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà..." 
              style="width: 100%; height: 100px; padding: 12px; border-radius: 8px; border: 1px solid #ccc; font-size: 16px; font-family: inherit; resize: vertical;"></textarea>
    <button onclick="sendMessage()" style="align-self: flex-end; margin-top: 10px; width: 150px;">Send / ‡∏™‡πà‡∏á</button>
    </div>
</div>

<script>
    async function sendMessage() {
    const inputField = document.getElementById('userInput'); // ‡∏´‡∏£‡∏∑‡∏≠ id ‡∏Ç‡∏≠‡∏á‡∏ä‡πà‡∏≠‡∏á‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°
    const message = inputField.value.trim();
    
    // --- ‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà 1: ‡∏î‡∏∂‡∏á‡∏Ñ‡πà‡∏≤ API Key ‡∏°‡∏≤‡∏à‡∏≤‡∏Å HTML ---
    // (‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏±‡πà‡∏ô‡πÉ‡∏à‡∏ß‡πà‡∏≤‡πÉ‡∏ô HTML ‡∏°‡∏µ <input id="apiKeyInput"> ‡πÅ‡∏•‡πâ‡∏ß)
    const apiKeyInput = document.getElementById('apiKeyInput');
    const apiKey = apiKeyInput ? apiKeyInput.value.trim() : "";

    // --- ‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà 2: ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡πà‡∏≠‡∏ô‡∏™‡πà‡∏á (Client-side Validation) ---
    if (!apiKey) {
        alert("‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å Groq API Key ‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏Ñ‡∏£‡∏±‡∏ö");
        if(apiKeyInput) apiKeyInput.focus(); // ‡πÄ‡∏î‡πâ‡∏á‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏ä‡πà‡∏≠‡∏á‡∏Å‡∏£‡∏≠‡∏Å Key ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
        return; // ‡∏´‡∏¢‡∏∏‡∏î‡∏ó‡∏≥‡∏á‡∏≤‡∏ô ‡πÑ‡∏°‡πà‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ Server
    }

    if (!message) return;

    // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ù‡∏±‡πà‡∏á‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏ö‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡∏ó‡∏±‡∏ô‡∏ó‡∏µ (UI Logic ‡πÄ‡∏î‡∏¥‡∏°)
    appendMessage('You', message);
    inputField.value = '';

    try {
        // --- ‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà 3: ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡∏¢‡∏±‡∏á Server ---
        const response = await fetch('/chat', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                message: message,
                role: document.getElementById('personaSelect').value,
                studentName: document.getElementById('studentName').value,
                studentId: document.getElementById('studentId').value,
                apiKey: apiKey  // <--- üî• ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏°‡∏≤‡∏Å: ‡∏™‡πà‡∏á Key ‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà
            })
        });

        const data = await response.json();

        if (response.ok) {
            // ‡∏Å‡∏£‡∏ì‡∏µ‡∏Ñ‡∏∏‡∏¢‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
            appendMessage('AI', data.text); 
        } else {
            // ‡∏Å‡∏£‡∏ì‡∏µ‡πÄ‡∏Å‡∏¥‡∏î Error (‡πÄ‡∏ä‡πà‡∏ô Key ‡∏ú‡∏¥‡∏î) ‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏™‡∏µ‡πÅ‡∏î‡∏á
            appendMessage('System', `‚ùå Error: ${data.text}`);
        }

    } catch (error) {
        console.error('Error:', error);
        appendMessage('System', '‚ùå Connection Error: ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ Server ‡πÑ‡∏î‡πâ');
    }
}

    // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏à‡∏≤‡∏Å 'keypress' ‡πÄ‡∏õ‡πá‡∏ô 'keydown' ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö textarea
    document.getElementById('userInput').addEventListener('keydown', function (e) {
        if (e.key === 'Enter' && !e.shiftKey) { // ‡∏Å‡∏î Enter ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡πà‡∏á (‡πÅ‡∏ï‡πà‡∏ñ‡πâ‡∏≤‡∏Å‡∏î Shift+Enter ‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡∏Ç‡∏∂‡πâ‡∏ô‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡πÉ‡∏´‡∏°‡πà)
            e.preventDefault();
            sendMessage();
        }
    });
</script>

</body>
</html>